<!DOCTYPE html>
<html>

<head>
  <title>Title goes here</title>
  <style>
    body {
      font-family: -apple-system,BlinkMacSystemFont,helvetica neue,helvetica,ubuntu,roboto,noto,arial,sans-serif
    }
    #content {
      margin: 0 auto;
      padding: 20px 0;
      width: 600px;
    }
    #links {
      float: right;
      font-size: 12px;
      margin-top: 28px;
    }
    #message {
      padding: 20px 0;
    }
    #message .item {
      padding: 4px 0;
    }
    button {
      font-size: 14px;
      background-color: #37b37e;
      color: #FFF;
      padding: 4px;
      border-radius: 4px;
    }

  </style>

  <script src="https://unpkg.com/transposit@0.3.1/dist/bundle.prod.js" /></script>
  <script>
    var transposit;
    var maintainer = "transposit";
    var serviceName = "raw_giphy";
    var host = "https://monkey.transposit.com";


    function renderPage() {
      transposit = new Transposit.Transposit(maintainer, serviceName, host);

      try {
        transposit.handleLogin();
      } catch (err) {
        // do nothing because we expect this to fail before the user logs in
      }

      var isLoggedIn = transposit.isLoggedIn();
      if (isLoggedIn) {
        runOperation();
        document.getElementById("links").innerHTML = "<a href='" + transposit.getConnectLocation() + "'>Settings</a>&nbsp;&nbsp;"
            + '<a href="#" onclick="logOut()">Log out</a>';
      } else {
        document.getElementById("shell").innerHTML = '<button type="button" onclick="loginWithGoogle()">Login</button>';
        document.getElementById("links").innerHTML = '';
      }
    }

    function loginWithGoogle() {
      window.location.href = host + "/app/v1/" + maintainer + "/" + serviceName + "/login/google?redirectUri=" + window.location.origin + window.location.pathname;
    }

    function logOut() {
      transposit.logOut();
      window.location.href = window.location.origin + window.location.pathname;
    }

    function runOperation() {
      // TODO: Once you build an operation, this is where you would call it through the Transposit client SDK
      var node = document.createElement('div');
      node.className = 'item';
      node.innerHTML = '... result of running an operation could go here ...';
      document.getElementById("message").appendChild(node);
    }
  </script>
</head>

<body>
<div id="content">
  <div id="links"></div>
  <h2>App title goes here</h2>
  <div id="shell"></div>
  <div id="message"></div>
</div>
<script>
  renderPage();
</script>
</body>

</html>